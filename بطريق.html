<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…ÙˆØ³ÙˆØ¹Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ | Ù†Ø³Ø®Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ø¬Ø¯Ø§Ù‹</title>
  <meta name="description" content="Ù…ÙˆÙ‚Ø¹ ÙˆÙŠØ¨ Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ù…Ù„Ù Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ + Ø¨Ø·Ø±ÙŠÙ‚ Ø²Ù†Ø¬Ø¨Ø§Ø±ÙŠ Ù…Ø¤ÙŠÙ‘Ø¯. Ø¨Ø­Ø«ØŒ ØªØµÙÙŠØ©ØŒ Ù…Ø®Ø·Ø·ØŒ Ø®Ø±ÙŠØ·Ø©ØŒ Ù…Ø¹Ø±Ø¶ØŒ Ø§Ø®ØªØ¨Ø§Ø± ØªÙØ§Ø¹Ù„ÙŠØŒ ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠØŒ ÙˆØµÙˆÙ„ÙŠØ©." />
  <style>
    /* ========================
       Ù†Ø¸Ø§Ù… ØªØµÙ…ÙŠÙ… Ø¨Ø³ÙŠØ· (CSS)
       ======================== */
    :root {
      --bg: #0b1320;
      --panel: #121a2b;
      --panel-2: #0f1626;
      --text: #f2f5ff;
      --muted: #c6cbe0;
      --brand: #6cc4ff;
      --brand-2: #00d0ff;
      --accent: #ffb703;
      --danger: #ff6b6b;
      --ok: #13ce66;
      --radius: 18px;
      --radius-sm: 12px;
      --shadow: 0 10px 35px rgba(0,0,0,.25), 0 2px 6px rgba(0,0,0,.2);
      --grid-gap: 18px;
      --maxw: 1280px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    body { background: var(--bg); color: var(--text); font-family: var(--sans); margin: 0; }
    .wrap { max-width: var(--maxw); margin: auto; padding: 22px; }
    header.site {
      position: sticky; top: 0; z-index: 50; backdrop-filter: blur(8px);
      background: linear-gradient(180deg, rgba(11,19,32,.9), rgba(11,19,32,.5));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .hero {
      display: grid; grid-template-columns: 1.2fr .8fr; gap: var(--grid-gap);
      padding: 22px 0; align-items: center;
    }
    .card { background: linear-gradient(180deg, var(--panel), var(--panel-2)); border: 1px solid rgba(255,255,255,.08); border-radius: var(--radius); box-shadow: var(--shadow); }
    .card.pad { padding: 18px; }
    .title { font-size: clamp(26px, 3vw, 44px); margin: 0 0 6px; letter-spacing: .3px; }
    .sub { color: var(--muted); margin: 0; }
    .bar { display: flex; gap: 10px; align-items: center; margin-top: 16px; flex-wrap: wrap; }
    .input, .select, .btn {
      background: #0d172a; color: var(--text); border: 1px solid rgba(255,255,255,.1);
      border-radius: var(--radius-sm); padding: 12px 14px; outline: none; font-size: 14px;
    }
    .btn { cursor: pointer; transition: .2s transform, .2s background; }
    .btn:hover { transform: translateY(-1px); }
    .btn.brand { background: linear-gradient(90deg, var(--brand), var(--brand-2)); color: #001018; border: none; font-weight: 700; letter-spacing: .3px; }
    .btn.ghost { background: transparent; border: 1px dashed rgba(255,255,255,.18); }

    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: var(--grid-gap); }
    .col-12 { grid-column: span 12; }
    .col-8 { grid-column: span 8; }
    .col-7 { grid-column: span 7; }
    .col-6 { grid-column: span 6; }
    .col-5 { grid-column: span 5; }
    .col-4 { grid-column: span 4; }
    .col-3 { grid-column: span 3; }

    @media (max-width: 980px){
      .hero { grid-template-columns: 1fr; }
      .col-8, .col-7, .col-6, .col-5, .col-4, .col-3 { grid-column: span 12; }
    }

    .species-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: var(--grid-gap); }
    .species-card { position: relative; overflow: hidden; }
    .species-card .thumb { height: 180px; background: #0e223a; display: grid; place-items: center; }
    .chip { display: inline-flex; gap: 8px; align-items: center; background: rgba(255,255,255,.06); padding: 6px 10px; border-radius: 999px; font-size: 12px; color: var(--muted); }
    .chip .dot { width: 8px; height: 8px; border-radius: 999px; }

    .tags { display: flex; flex-wrap: wrap; gap: 8px; }

    .kpis { display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--grid-gap); }
    .kp { padding: 14px; border-radius: var(--radius-sm); background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.08); }
    .kp b { font-size: 22px; }

    .section-title { font-size: 22px; margin: 0 0 10px; }
    .muted { color: var(--muted); }

    /* Ø±Ø³Ù… Ø®Ø±ÙŠØ·Ø© SVG Ù…Ø¨Ø³Ø·Ø© Ù„Ù„Ø¹Ø§Ù„Ù… */
    svg.map { width: 100%; height: auto; display: block; }
    .region { fill: #123; stroke: #234; stroke-width: .6; }
    .region[data-hot="1"] { fill: #1a3455; }
    .pin { fill: var(--accent); stroke: #000; stroke-width: .3; opacity: .8; }

    /* Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© */
    dialog.modal { border: none; border-radius: 18px; padding: 0; background: transparent; }
    .modal .sheet { background: linear-gradient(180deg, var(--panel), var(--panel-2)); color: var(--text); border-radius: 18px; box-shadow: var(--shadow); width: min(840px, 94vw); overflow: hidden; }
    .modal .sheet header { display: flex; justify-content: space-between; align-items: center; padding: 14px 16px; border-bottom: 1px solid rgba(255,255,255,.08); }
    .modal .content { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; padding: 16px; }
    @media (max-width: 900px){ .modal .content { grid-template-columns: 1fr; } }

    /* Ø¬Ø¯ÙˆÙ„ */
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px 12px; border-bottom: 1px dashed rgba(255,255,255,.12); text-align: right; }
    th { color: var(--muted); font-weight: 600; letter-spacing: .2px; }

    /* Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ SVG Ø¨Ø³ÙŠØ· */
    .chart { width: 100%; height: 180px; background: rgba(255,255,255,.04); border-radius: var(--radius-sm); border: 1px solid rgba(255,255,255,.08); }

    /* ØªØ¨ÙˆÙŠØ¨Ø§Øª */
    .tabs { display: flex; gap: 8px; flex-wrap: wrap; }
    .tab { padding: 8px 12px; border-radius: 999px; background: rgba(255,255,255,.06); cursor: pointer; border: 1px solid transparent; user-select: none; }
    .tab[aria-selected="true"] { background: linear-gradient(90deg, var(--brand), var(--brand-2)); color: #001018; border-color: rgba(0,0,0,.15); font-weight: 700; }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± */
    .quiz-q { padding: 14px; border-radius: var(--radius-sm); border: 1px solid rgba(255,255,255,.1); background: rgba(255,255,255,.04); }
    .quiz-q h4 { margin: 0 0 6px; }

    footer.site { margin-top: 40px; border-top: 1px solid rgba(255,255,255,.08); padding: 16px 0 40px; color: var(--muted); }

    /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰ */
    .to-top { position: fixed; bottom: 18px; left: 18px; z-index: 60; display: none; }
    .to-top.show { display: block; }
  </style>
</head>
<body>
  <header class="site">
    <div class="wrap">
      <div class="hero">
        <div class="card pad">
          <h1 class="title">Ù…ÙˆØ³ÙˆØ¹Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ <span aria-hidden>ğŸ§</span></h1>
          <p class="sub">Ø¯Ù„ÙŠÙ„ ØªÙØ§Ø¹Ù„ÙŠ Ø´Ø§Ù…Ù„ Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ Ø­ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù… Ù…Ø¹ ØµÙˆØ± SVG Ù…ÙØ¶Ù…Ù‘Ù†Ø©ØŒ ÙˆØ®Ø±Ø§Ø¦Ø· Ø§Ù†ØªØ´Ø§Ø±ØŒ ÙˆØ¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†ØŒ ÙˆØ§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹. ÙŠØªØ¶Ù…Ù† Ù†ÙˆØ¹Ø§Ù‹ Ø®ÙŠØ§Ù„ÙŠØ§Ù‹: <b>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø²Ù†Ø¬Ø¨Ø§Ø±ÙŠ (Ù…Ø¤ÙŠÙ‘Ø¯)</b> âœ¨.</p>
          <div class="bar">
            <input class="input" id="q" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù†ÙˆØ¹ØŒ Ø§Ù„Ù…ÙˆØ·Ù†ØŒ Ø£Ùˆ Ø§Ù„Ø³Ù„ÙˆÙƒâ€¦" />
            <select class="select" id="filterRegion" title="ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø§Ø±Ø©">
              <option value="">ÙƒÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</option>
              <option>Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§</option>
              <option>Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§</option>
              <option>Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©</option>
              <option>Ø£ÙØ±ÙŠÙ‚ÙŠØ§</option>
              <option>Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ù†Ø¯ÙŠ</option>
            </select>
            <select class="select" id="filterSize" title="ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø¬Ù…">
              <option value="">ÙƒÙ„ Ø§Ù„Ø£Ø­Ø¬Ø§Ù…</option>
              <option value="ØµØºÙŠØ±">ØµØºÙŠØ±</option>
              <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
              <option value="ÙƒØ¨ÙŠØ±">ÙƒØ¨ÙŠØ±</option>
            </select>
            <button class="btn brand" id="downloadJson">ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª JSON</button>
            <button class="btn ghost" id="themeBtn" aria-pressed="false">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button>
          </div>
        </div>
        <div class="card pad">
          <div class="kpis">
            <div class="kp"><div class="muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</div><b id="kTotal">â€”</b></div>
            <div class="kp"><div class="muted">Ù…Ù‡Ø¯Ø¯ Ø¨Ø§Ù„Ø§Ù†Ù‚Ø±Ø§Ø¶</div><b id="kThreat">â€”</b></div>
            <div class="kp"><div class="muted">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·ÙˆÙ„</div><b id="kAvgH">â€”</b></div>
            <div class="kp"><div class="muted">Ù…ØªÙˆØ³Ø· Ø§Ù„ÙˆØ²Ù†</div><b id="kAvgW">â€”</b></div>
          </div>
          <div class="bar" style="margin-top:14px">
            <div class="chip" title="Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©"><span class="dot" style="background:var(--accent)"></span><span id="chipCount">â€”</span></div>
            <div class="chip" title="Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«"><span class="dot" style="background:var(--brand)"></span><span id="chipSearch">â€”</span></div>
            <div class="chip" title="Ø§Ù„ØªØµÙÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©"><span class="dot" style="background:#9ae6b4"></span><span id="chipFilter">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span></div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      <div class="col-8">
        <div class="card pad">
          <div class="tabs" role="tablist" aria-label="Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø­ØªÙˆÙ‰">
            <button class="tab" role="tab" aria-selected="true" data-tab="gallery">Ø§Ù„Ù…Ø¹Ø±Ø¶</button>
            <button class="tab" role="tab" aria-selected="false" data-tab="table">Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
            <button class="tab" role="tab" aria-selected="false" data-tab="map">Ø§Ù„Ø®Ø±ÙŠØ·Ø©</button>
            <button class="tab" role="tab" aria-selected="false" data-tab="quiz">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ</button>
          </div>
          <div id="panels" style="margin-top: 16px">
            <section id="panel-gallery" role="tabpanel">
              <div class="species-grid" id="grid"></div>
            </section>
            <section id="panel-table" role="tabpanel" hidden>
              <div class="muted" style="margin-bottom:8px">Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ÙØ±Ø² Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†.</div>
              <div style="overflow:auto"><table id="tbl"></table></div>
            </section>
            <section id="panel-map" role="tabpanel" hidden>
              <div class="muted" style="margin-bottom:8px">Ø®Ø±ÙŠØ·Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø§Ù†ØªØ´Ø§Ø± (ØªÙ‚Ø±ÙŠØ¨ÙŠØ©).</div>
              <svg class="map" viewBox="0 0 1200 520" aria-label="Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹Ø§Ù„Ù…">
                <rect width="1200" height="520" fill="#0b1a2c" rx="18" ry="18" />
                <!-- Ø£Ø´ÙƒØ§Ù„ Ù‚Ø§Ø±Ø§Øª Ù…Ø¨Ø³Ø·Ø© -->
                <path class="region" d="M180 120l220-20 80 60-30 80-120 40-150-60z"/>
                <path class="region" d="M480 130l110-30 140 30 50 50-80 40-120-20z"/>
                <path class="region" d="M850 150l180-20 60 50-20 60-180 40-40-30z"/>
                <path class="region" d="M540 350l160 20 60 40-60 50-170 10-40-50z"/>
                <!-- Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§ -->
                <path class="region" data-hot="1" d="M970 400l80 0 40 20-20 30-70 10-40-15z"/>
                <!-- Ø¯Ø¨Ø§Ø¨ÙŠØ³ Ø§Ù†ØªØ´Ø§Ø± Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ -->
                <circle class="pin" cx="1010" cy="420" r="6"><title>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠ</title></circle>
                <circle class="pin" cx="560" cy="370" r="6"><title>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ù‡Ù…Ø¨ÙˆÙ„Øª</title></circle>
                <circle class="pin" cx="930" cy="410" r="6"><title>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ù„ÙŠØªÙ„ Ø¨Ù„Ùˆ</title></circle>
                <circle class="pin" cx="760" cy="390" r="6"><title>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ø¢Ø¯ÙŠÙ„ÙŠ</title></circle>
                <circle class="pin" cx="860" cy="450" r="6"><title>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ø²Ù†Ø¬Ø¨Ø§Ø±ÙŠ (Ù…Ø¤ÙŠÙ‘Ø¯)</title></circle>
              </svg>
            </section>
            <section id="panel-quiz" role="tabpanel" hidden>
              <div id="quiz"></div>
              <div class="bar" style="margin-top:12px">
                <button class="btn brand" id="checkQuiz">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</button>
                <button class="btn" id="regenQuiz">Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</button>
              </div>
              <div id="quizResult" class="muted" style="margin-top:8px"></div>
            </section>
          </div>
        </div>
      </div>
      <aside class="col-4">
        <div class="card pad">
          <h3 class="section-title">Ø­ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h3>
          <p class="muted">Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ø­Ø§Ø¯ÙŠ Ø§Ù„Ù…Ù„Ù (HTML + CSS + JS) Ù…ØµÙ…Ù… Ù„Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© ÙƒØ§Ù…Ù„Ø© Ù…Ù† Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©ØŒ Ù…Ø¹ ØµÙˆØ± SVG Ù…ÙˆÙ„Ø¯Ø© Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ØŒ ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø­Ø¬Ù… ÙˆØ§Ù„ÙˆØ²Ù† ÙˆØ§Ù„Ø­ÙÙ…ÙŠØ© ÙˆØ­Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸. Ø£Ø¶ÙÙ†Ø§ Ø£ÙŠØ¶Ø§Ù‹ Ù†ÙˆØ¹Ø§Ù‹ Ø®ÙŠØ§Ù„ÙŠØ§Ù‹ Ø¨Ø·Ø§Ø¨Ø¹ Ø·Ø±ÙŠÙ: <b>Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø²Ù†Ø¬Ø¨Ø§Ø±ÙŠ (Ù…Ø¤ÙŠÙ‘Ø¯)</b> Ø§Ù„Ù…Ù…ÙŠØ² Ø¨Ù„ÙˆÙ†Ù‡ Ø§Ù„Ø¯Ø§ÙØ¦ ÙˆØ¥Ø¹Ø¬Ø§Ø¨Ù‡ Ø¨Ø§Ù„Ø²Ù†Ø¬Ø¨ÙŠÙ„ ğŸµ.</p>
          <ul class="muted">
            <li>Ø¨Ø­Ø« ÙÙˆØ±ÙŠ + ØªØµÙÙŠØ© Ù…ØªØ¹Ø¯Ø¯Ø©.</li>
            <li>Ø¬Ø¯ÙˆÙ„ Ù‚Ø§Ø¨Ù„ Ù„Ù„ÙØ±Ø².</li>
            <li>Ø®Ø±ÙŠØ·Ø© SVG ØªÙØ§Ø¹Ù„ÙŠØ© (ØªÙ‚Ø±ÙŠØ¨ÙŠØ©).</li>
            <li>Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨Ù…Ø³ØªÙˆÙŠØ§Øª Ù…Ø®ØªÙ„ÙØ©.</li>
            <li>Ø­ÙØ¸ Ù…ÙØ¶Ù„Ø§ØªÙƒ Ù…Ø­Ù„ÙŠØ§Ù‹.</li>
            <li>ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ.</li>
          </ul>
        </div>
        <div class="card pad" style="margin-top:18px">
          <h3 class="section-title">Ù…Ø®Ø·Ø· Ø¨Ø³ÙŠØ·: Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·ÙˆÙ„</h3>
          <svg id="chartH" class="chart" viewBox="0 0 600 180" aria-label="Ù…Ø®Ø·Ø· Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©"></svg>
        </div>
      </aside>
    </section>
  </main>

  <dialog id="dlg" class="modal">
    <div class="sheet">
      <header>
        <strong id="dlgTitle">â€”</strong>
        <button id="closeDlg" class="btn">Ø¥ØºÙ„Ø§Ù‚</button>
      </header>
      <div class="content">
        <div>
          <div id="dlgImg" class="thumb" style="height:240px"></div>
          <div class="bar" style="margin-top:8px">
            <button class="btn brand" id="favBtn">â­ Ø£Ø¶ÙÙ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©</button>
            <button class="btn" id="speakBtn">ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙˆØµÙ</button>
          </div>
        </div>
        <div>
          <table id="dlgTbl"></table>
          <p class="muted" id="dlgDesc">â€”</p>
        </div>
      </div>
    </div>
  </dialog>

  <button id="toTop" class="btn to-top">â¬†ï¸ Ù„Ù„Ø£Ø¹Ù„Ù‰</button>

  <script>
  // =======================
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ (18+1)
  // =======================
  const SPECIES = [
    { id: 'emperor', name:'Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠ', latin:'Aptenodytes forsteri', size:'ÙƒØ¨ÙŠØ±', height_cm:115, weight_kg:35, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§', diet:'Ø£Ø³Ù…Ø§ÙƒØŒ ÙƒØ±ÙŠÙ„', status:'Ù…Ù‡Ø¯Ø¯ Ù…Ù†Ø®ÙØ¶', color:'#9dd1ff', desc:'Ø£ÙƒØ¨Ø± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ØŒ ÙŠØ¹ÙŠØ´ ÙÙŠ Ù…Ø³ØªØ¹Ù…Ø±Ø§Øª Ø¶Ø®Ù…Ø© ÙˆÙŠÙ‚Ø·Ø¹ Ù…Ø³Ø§ÙØ§Øª Ø·ÙˆÙŠÙ„Ø© ÙÙˆÙ‚ Ø§Ù„Ø¬Ù„ÙŠØ¯.' },
    { id: 'king', name:'Ø§Ù„Ù…Ù„ÙƒÙŠ', latin:'Aptenodytes patagonicus', size:'ÙƒØ¨ÙŠØ±', height_cm:95, weight_kg:17, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§/Ø¬Ø²Ø±', diet:'Ø£Ø³Ù…Ø§ÙƒØŒ ÙƒØ±ÙŠÙ„', status:'ØºÙŠØ± Ù…Ù‡Ø¯Ø¯', color:'#ffd166', desc:'ÙŠØ´Ø¨Ù‡ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠ Ù„ÙƒÙ† Ø£ØµØºØ±ØŒ Ø¨Ù‚Ø¹ ØµÙØ±Ø§Ø¡ Ø²Ø§Ù‡ÙŠØ© Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù†Ù‚.' },
    { id: 'adelie', name:'Ø¢Ø¯ÙŠÙ„ÙŠ', latin:'Pygoscelis adeliae', size:'Ù…ØªÙˆØ³Ø·', height_cm:70, weight_kg:5, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§', diet:'ÙƒØ±ÙŠÙ„', status:'ØºÙŠØ± Ù…Ù‡Ø¯Ø¯', color:'#e0fbfc', desc:'Ø¹ÙŠÙ†Ø§Ù† Ø¨Ø§Ø±Ø²ØªØ§Ù† ÙˆØ­Ù„Ù‚Ø© Ø¨ÙŠØ¶Ø§Ø¡Ø› Ø³Ø¨Ù‘Ø§Ø­ Ù†Ø´ÙŠØ·.' },
    { id: 'chinstrap', name:'Ø°Ùˆ Ø§Ù„Ø¹ÙØµØ§Ø¨Ø©', latin:'Pygoscelis antarcticus', size:'Ù…ØªÙˆØ³Ø·', height_cm:68, weight_kg:4, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§', diet:'ÙƒØ±ÙŠÙ„', status:'ØºÙŠØ± Ù…Ù‡Ø¯Ø¯', color:'#caffbf', desc:'Ø´Ø±ÙŠØ· Ø£Ø³ÙˆØ¯ ØªØ­Øª Ø§Ù„Ø°Ù‚Ù† ÙƒØ§Ù„Ø¹ØµØ§Ø¨Ø©.' },
    { id: 'gentoo', name:'Ø¬Ù†ØªÙˆ', latin:'Pygoscelis papua', size:'Ù…ØªÙˆØ³Ø·', height_cm:75, weight_kg:5.5, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§/Ø¬Ø²Ø±', diet:'Ø£Ø³Ù…Ø§ÙƒØŒ ÙƒØ±ÙŠÙ„', status:'Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯', color:'#ffd6a5', desc:'Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø¹ ØªØ­Øª Ø§Ù„Ù…Ø§Ø¡Ø› Ù…Ù†Ù‚Ø§Ø± Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ù„Ø§Ù…Ø¹.' },
    { id: 'humboldt', name:'Ù‡Ù…Ø¨ÙˆÙ„Øª', latin:'Spheniscus humboldti', size:'Ù…ØªÙˆØ³Ø·', height_cm:70, weight_kg:4.5, region:'Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©', diet:'Ø£Ø³Ù…Ø§Ùƒ', status:'Ù…Ù‡Ø¯Ø¯', color:'#ffc6ff', desc:'ÙŠØ³ÙƒÙ† Ø³ÙˆØ§Ø­Ù„ Ø¨ÙŠØ±Ùˆ ÙˆØªØ´ÙŠÙ„ÙŠ ÙˆÙŠØªØ£Ø«Ø± Ø¨Ø¸Ø§Ù‡Ø±Ø© Ø§Ù„Ù†ÙŠÙ†ÙŠÙˆ.' },
    { id: 'magellanic', name:'Ù…Ø§ØºÙ„Ø§Ù†ÙŠ', latin:'Spheniscus magellanicus', size:'Ù…ØªÙˆØ³Ø·', height_cm:70, weight_kg:5, region:'Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©', diet:'Ø£Ø³Ù…Ø§Ùƒ', status:'Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯', color:'#bdb2ff', desc:'Ø­Ù„Ù‚Ø§Øª Ø³ÙˆØ¯Ø§Ø¡ Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ù…ÙŠØ²Ø© Ø¹Ù„Ù‰ Ø§Ù„ØµØ¯Ø±.' },
    { id: 'galapagos', name:'ØºÙ„Ø§Ù¾Ø§ØºÙˆØ³', latin:'Spheniscus mendiculus', size:'ØµØºÙŠØ±', height_cm:49, weight_kg:2.5, region:'Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©/ØºÙ„Ø§Ù¾Ø§ØºÙˆØ³', diet:'Ø£Ø³Ù…Ø§Ùƒ', status:'Ù…Ù‡Ø¯Ø¯ Ø¨Ø´Ø¯Ø©', color:'#ffadad', desc:'Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªÙˆØ§Ø¦ÙŠ Ø§Ù„ÙˆØ­ÙŠØ¯Ø› ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ØªÙŠØ§Ø± Ù‡ÙˆÙ…Ø¨ÙˆÙ„Øª Ø§Ù„Ø¨Ø§Ø±Ø¯.' },
    { id: 'african', name:'Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ', latin:'Spheniscus demersus', size:'Ù…ØªÙˆØ³Ø·', height_cm:60, weight_kg:3, region:'Ø£ÙØ±ÙŠÙ‚ÙŠØ§', diet:'Ø£Ø³Ù…Ø§Ùƒ', status:'Ù…Ù‡Ø¯Ø¯', color:'#ffdbe0', desc:'ÙŠÙØ³Ù…Ù‰ Ø£ÙŠØ¶Ø§Ù‹ Ø¨Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø­Ù…Ø§Ø± Ù„ØµÙˆØªÙ‡ Ø§Ù„Ù…Ù…ÙŠØ².' },
    { id: 'little', name:'Ø§Ù„ØµØºÙŠØ± Ø§Ù„Ø£Ø²Ø±Ù‚', latin:'Eudyptula minor', size:'ØµØºÙŠØ±', height_cm:33, weight_kg:1.2, region:'Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§', diet:'Ø£Ø³Ù…Ø§Ùƒ', status:'ØºÙŠØ± Ù…Ù‡Ø¯Ø¯', color:'#a0c4ff', desc:'Ø£ØµØºØ± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠÙ‚ Ù„ÙˆÙ†ÙÙ‡ Ø£Ø²Ø±Ù‚ Ø¨Ø§Ù‡Øª.' },
    { id: 'fiordland', name:'ÙÙŠÙˆØ±Ø¯Ù„Ø§Ù†Ø¯', latin:'Eudyptes pachyrhynchus', size:'Ù…ØªÙˆØ³Ø·', height_cm:55, weight_kg:3.5, region:'Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§/Ù†ÙŠÙˆØ²ÙŠÙ„Ù†Ø¯Ø§', diet:'Ø£Ø³Ù…Ø§ÙƒØŒ ÙƒØ±ÙŠÙ„', status:'Ù…Ù‡Ø¯Ø¯', color:'#d0f4de', desc:'Ø®ØµØ§Ù„ ØµÙØ±Ø§Ø¡ ÙÙˆÙ‚ Ø§Ù„Ø¹ÙŠÙ†ÙŠÙ† Ù…Ø«Ù„ Ø§Ù„Ø­ÙˆØ§Ø¬Ø¨.' },
    { id: 'snares', name:'Ø³Ù†ÙŠØ±Ø²', latin:'Eudyptes robustus', size:'Ù…ØªÙˆØ³Ø·', height_cm:60, weight_kg:3.8, region:'Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§/Ù†ÙŠÙˆØ²ÙŠÙ„Ù†Ø¯Ø§', diet:'ÙƒØ±ÙŠÙ„', status:'Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯', color:'#caf0f8', desc:'Ø¹Ø±Ù Ø£ØµÙØ± Ø¨Ø§Ø±Ø²Ø› Ù…Ø³ØªØ¹Ù…Ø±Ø§Øª ÙƒØ«ÙŠÙØ©.' },
    { id: 'erect', name:'Ø°Ùˆ Ø§Ù„Ø¹Ø±Ù Ø§Ù„Ù…Ù†ØªØµØ¨', latin:'Eudyptes sclateri', size:'Ù…ØªÙˆØ³Ø·', height_cm:58, weight_kg:3.7, region:'Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§', diet:'ÙƒØ±ÙŠÙ„', status:'Ù…Ù‡Ø¯Ø¯', color:'#f1faee', desc:'Ø³ÙˆØ§Ù„Ù ØµÙØ±Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù„Ù‰.' },
    { id: 'rockhopper', name:'Ø±ÙˆÙƒÙ‡ÙˆØ¨Ø±', latin:'Eudyptes chrysocome', size:'ØµØºÙŠØ±', height_cm:52, weight_kg:2.8, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§/Ø¬Ø²Ø±', diet:'ÙƒØ±ÙŠÙ„', status:'Ù…Ù‡Ø¯Ø¯', color:'#e9ff70', desc:'Ù‚ÙØ²Ø§Øª ØµØ®Ø±ÙŠØ© Ø³Ø±ÙŠØ¹Ø© ÙˆØ±ÙŠØ´ Ø£ØµÙØ± Ø­ÙˆÙ„ Ø§Ù„Ø¹ÙŠÙ†.' },
    { id: 'macaroni', name:'Ù…Ø§ÙƒØ§Ø±ÙˆÙ†ÙŠ', latin:'Eudyptes chrysolophus', size:'Ù…ØªÙˆØ³Ø·', height_cm:69, weight_kg:5.5, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§/Ø¬Ø²Ø±', diet:'ÙƒØ±ÙŠÙ„', status:'Ù…Ù‡Ø¯Ø¯', color:'#ffe066', desc:'Ø¹Ø±Ù Ø£ØµÙØ± ÙƒØ«ÙŠÙ Ù…Ø«Ù„ Ø§Ù„Ù…Ø¹ÙƒØ±ÙˆÙ†Ø© Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠØ© â­.' },
    { id: 'royal', name:'Ø±ÙˆÙŠØ§Ù„', latin:'Eudyptes schlegeli', size:'Ù…ØªÙˆØ³Ø·', height_cm:70, weight_kg:5.5, region:'Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§/Ø¬Ø²Ø±', diet:'ÙƒØ±ÙŠÙ„', status:'Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯', color:'#ffd166', desc:'ÙŠØ´Ø¨Ù‡ Ù…Ø§ÙƒØ§Ø±ÙˆÙ†ÙŠ Ù„ÙƒÙ† Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª Ø¬ÙŠÙ†ÙŠØ© ÙˆÙ…ÙˆÙ‚Ø¹ÙŠØ©.' },
    { id: 'yellow', name:'ØµÙØ±Ø§Ø¡ Ø§Ù„Ø¹ÙŠÙ†ÙŠÙ†', latin:'Megadyptes antipodes', size:'Ù…ØªÙˆØ³Ø·', height_cm:65, weight_kg:5, region:'Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§/Ù†ÙŠÙˆØ²ÙŠÙ„Ù†Ø¯Ø§', diet:'Ø£Ø³Ù…Ø§Ùƒ', status:'Ù…Ù‡Ø¯Ø¯ Ø¨Ø´Ø¯Ø©', color:'#fff3b0', desc:'Ø¹ÙŠÙˆÙ† ØµÙØ±Ø§Ø¡ Ù„Ø§Ù…Ø¹Ø© ÙˆØ®Ø¯ÙˆØ¯ Ø´Ø§Ø­Ø¨Ø©.' },
    { id: 'gentle', name:'Ø³Ù†ÙŠØ§Ø±ÙŠ', latin:'Eudyptes moseleyi', size:'Ù…ØªÙˆØ³Ø·', height_cm:60, weight_kg:3.9, region:'Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§/Ø¬Ø²Ø± ØªØ±ÙŠØ³ØªØ§Ù†', diet:'ÙƒØ±ÙŠÙ„', status:'Ù…Ù‡Ø¯Ø¯ Ø¨Ø´Ø¯Ø©', color:'#cdeac0', desc:'ÙŠØ³Ù…Ù‰ Ø£ÙŠØ¶Ø§Ù‹ Northern rockhopper.' },
    // Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø®ÙŠØ§Ù„ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
    { id: 'zanzibari', name:'Ø§Ù„Ø²Ù†Ø¬Ø¨Ø§Ø±ÙŠ (Ù…Ø¤ÙŠÙ‘Ø¯)', latin:'Spheniscus zingiberi (Ø®ÙŠØ§Ù„ÙŠ)', size:'Ù…ØªÙˆØ³Ø·', height_cm:62, weight_kg:3.2, region:'Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ù†Ø¯ÙŠ', diet:'Ø£Ø³Ù…Ø§ÙƒØŒ Ø±ÙˆØ¨ÙŠØ§Ù†ØŒ Ø¬Ø°ÙˆØ± Ø§Ù„Ø²Ù†Ø¬Ø¨ÙŠÙ„ Ø§Ù„Ø¨Ø­Ø±ÙŠØ©', status:'ØºÙŠØ± Ù…ÙˆØµÙ‘Ù', color:'#ffb4a2', desc:'Ø¨Ø·Ø±ÙŠÙ‚ Ø®ÙŠØ§Ù„ÙŠ Ù…Ù† Ø¬Ø²Ø± Ø²Ù†Ø¬Ø¨Ø§Ø± ÙŠØ­Ø¨ Ø±Ø§Ø¦Ø­Ø© Ø§Ù„Ø²Ù†Ø¬Ø¨ÙŠÙ„ ÙˆÙŠØªÙ…ÙŠØ² Ø¨Ø±Ù‚Ø¹Ø© ØµØ¯Ø±ÙŠØ© Ø¯Ø§ÙØ¦Ø© Ø§Ù„Ù„ÙˆÙ† ÙˆÙØ¶ÙˆÙ„Ù ÙƒØ¨ÙŠØ±.' }
  ];

  // ===============
  // Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø©
  // ===============
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const fmt = n => new Intl.NumberFormat('ar-EG').format(n);

  function svgPenguin(color='#9dd1ff'){ // ØµÙˆØ±Ø© SVG Ù…ÙˆÙ„Ù‘Ø¯Ø©
    return `
    <svg viewBox="0 0 180 180" width="100%" height="100%" role="img" aria-label="Ø±Ø³Ù… Ø¨Ø·Ø±ÙŠÙ‚">
      <defs>
        <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0" stop-color="#0b1a2c"/>
          <stop offset="1" stop-color="#203a5e"/>
        </linearGradient>
      </defs>
      <rect x="0" y="0" width="180" height="180" rx="16" fill="url(#g1)"/>
      <g transform="translate(90,100)">
        <ellipse cx="0" cy="36" rx="26" ry="14" fill="#141e30" opacity=".6"/>
      </g>
      <g transform="translate(90,84)">
        <path d="M0-52 c28 0 40 22 38 44 s-14 40-38 40 -38-18-38-40 10-44 38-44z" fill="#111" stroke="#000" stroke-width="1"/>
        <circle cx="-10" cy="-18" r="6" fill="#fff"/>
        <circle cx="10" cy="-18" r="6" fill="#fff"/>
        <circle cx="-10" cy="-18" r="2" fill="#000"/>
        <circle cx="10" cy="-18" r="2" fill="#000"/>
        <path d="M-8 -10 l8 -4 l8 4 l-8 6z" fill="#ffb703"/>
        <path d="M0 24 c24 0 26-28 22-40 c-4 12-10 14-22 14s-18-2-22-14c-4 12-2 40 22 40z" fill="${color}"/>
        <path d="M-44 -12 c-10 10 -14 36 6 50 c6 4 10 4 16 2 c-10 -10 -12 -28 -10 -44z" fill="#0f1e33" opacity=".8"/>
        <path d="M44 -12 c10 10 14 36 -6 50 c-6 4 -10 4 -16 2 c10 -10 12 -28 10 -44z" fill="#0f1e33" opacity=".8"/>
      </g>
    </svg>`;
  }

  // Ø±Ø³Ù… Ø¹Ù…ÙˆØ¯ Ø¨Ø³ÙŠØ· Ø¯Ø§Ø®Ù„ SVG
  function drawBar(svg, x, h, label){
    const yBase = 160; const w = 18; const y = yBase - h;
    svg.insertAdjacentHTML('beforeend', `<rect x="${x}" y="${y}" width="${w}" height="${h}" rx="6" fill="#6cc4ff" />`);
    svg.insertAdjacentHTML('beforeend', `<text x="${x + w/2}" y="170" font-size="10" text-anchor="middle" fill="#d0d6ea">${label}</text>`);
  }

  // Ø¨Ù†Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ù†ÙˆØ¹
  function speciesCard(s){
    const favs = getFavs();
    const fav = favs.includes(s.id);
    return `
      <article class="species-card card">
        <div class="thumb">${svgPenguin(s.color)}</div>
        <div class="pad" style="padding:12px 14px">
          <header style="display:flex;align-items:center;justify-content:space-between;gap:8px">
            <div>
              <h3 style="margin:0">${s.name}</h3>
              <div class="muted" style="font-size:12px">${s.latin}</div>
            </div>
            <button class="btn" data-open="${s.id}">${fav? 'â­' : 'â˜†'}</button>
          </header>
          <div class="tags" style="margin-top:10px">
            <span class="chip"><span class="dot" style="background:#9ae6b4"></span>${s.size}</span>
            <span class="chip"><span class="dot" style="background:#93c5fd"></span>${s.region}</span>
            <span class="chip"><span class="dot" style="background:#fda4af"></span>${s.status}</span>
          </div>
        </div>
      </article>`;
  }

  // Ø¬Ø¯ÙˆÙ„
  function buildTable(data){
    const headers = [
      {k:'name', t:'Ø§Ù„Ø§Ø³Ù…'},
      {k:'latin', t:'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ù„Ù…ÙŠ'},
      {k:'region', t:'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©'},
      {k:'size', t:'Ø§Ù„Ø­Ø¬Ù…'},
      {k:'height_cm', t:'Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)'},
      {k:'weight_kg', t:'Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…)'},
      {k:'status', t:'Ø§Ù„Ø­ÙØ¸'}
    ];
    const thead = `<thead><tr>${headers.map(h=>`<th data-k="${h.k}">${h.t}</th>`).join('')}</tr></thead>`;
    const rows = data.map(s=>`<tr>
      <td>${s.name}</td>
      <td class="muted">${s.latin}</td>
      <td>${s.region}</td>
      <td>${s.size}</td>
      <td>${fmt(s.height_cm)}</td>
      <td>${fmt(s.weight_kg)}</td>
      <td>${s.status}</td>
    </tr>`).join('');
    $('#tbl').innerHTML = thead + `<tbody>${rows}</tbody>`;

    // ÙØ±Ø²
    $('#tbl').onclick = (e)=>{
      const th = e.target.closest('th'); if(!th) return;
      const k = th.dataset.k; const asc = th.dataset.asc !== 'true';
      const sorted = [...data].sort((a,b)=> (a[k] > b[k]? 1 : a[k] < b[k]? -1 : 0) * (asc? 1 : -1));
      th.dataset.asc = asc;
      buildTable(sorted);
    };
  }

  // Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„
  function openDetails(id){
    const s = SPECIES.find(x=>x.id===id);
    if(!s) return;
    $('#dlgTitle').textContent = `${s.name} â€” ${s.latin}`;
    $('#dlgImg').innerHTML = svgPenguin(s.color);
    $('#dlgDesc').textContent = s.desc;
    $('#dlgTbl').innerHTML = `
      <tr><th>Ø§Ù„Ø­Ø¬Ù…</th><td>${s.size}</td></tr>
      <tr><th>Ø§Ù„Ø·ÙˆÙ„</th><td>${fmt(s.height_cm)} Ø³Ù…</td></tr>
      <tr><th>Ø§Ù„ÙˆØ²Ù†</th><td>${fmt(s.weight_kg)} ÙƒØ¬Ù…</td></tr>
      <tr><th>Ø§Ù„Ù…ÙˆØ·Ù†</th><td>${s.region}</td></tr>
      <tr><th>Ø§Ù„Ø­ÙÙ…ÙŠØ©</th><td>${s.diet}</td></tr>
      <tr><th>Ø­Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸</th><td>${s.status}</td></tr>
    `;
    $('#favBtn').onclick = ()=>toggleFav(s.id);
    $('#speakBtn').onclick = ()=> speak(`${s.name}. ${s.desc}`);
    $('#dlg').showModal();
  }

  // Ù…ÙØ¶Ù„Ø§Øª Ù…Ø­Ù„ÙŠØ©
  function getFavs(){ try{ return JSON.parse(localStorage.getItem('p_favs')||'[]'); } catch{ return []; } }
  function toggleFav(id){
    const favs = getFavs();
    const i = favs.indexOf(id);
    if(i>-1) favs.splice(i,1); else favs.push(id);
    localStorage.setItem('p_favs', JSON.stringify(favs));
    render();
  }

  // Ø¨Ø­Ø« + ØªØµÙÙŠØ©
  function filterAll(){
    const q = ($('#q').value||'').trim().toLowerCase();
    const r = $('#filterRegion').value;
    const sz = $('#filterSize').value;
    let out = SPECIES.filter(s=>
      (!r || s.region.includes(r)) &&
      (!sz || s.size===sz) &&
      (!q || [s.name, s.latin, s.region, s.diet, s.status].join(' ').toLowerCase().includes(q))
    );
    $('#chipSearch').textContent = q? `"${q}"` : 'â€”';
    $('#chipFilter').textContent = [r, sz].filter(Boolean).join(' + ') || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
    return out;
  }

  // Ø±Ø³Ù… Ø§Ù„Ù…Ø®Ø·Ø· (Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·ÙˆÙ„ Ù„ÙƒÙ„ ÙØ¦Ø© Ø­Ø¬Ù…)
  function drawChart(){
    const svg = $('#chartH'); svg.innerHTML = '';
    const groups = {
      'ØµØºÙŠØ±': SPECIES.filter(s=>s.size==='ØµØºÙŠØ±'),
      'Ù…ØªÙˆØ³Ø·': SPECIES.filter(s=>s.size==='Ù…ØªÙˆØ³Ø·'),
      'ÙƒØ¨ÙŠØ±': SPECIES.filter(s=>s.size==='ÙƒØ¨ÙŠØ±')
    };
    const av = k => Math.round(groups[k].reduce((a,c)=>a+c.height_cm,0)/groups[k].length);
    const vals = ['ØµØºÙŠØ±','Ù…ØªÙˆØ³Ø·','ÙƒØ¨ÙŠØ±'].map(g=>({g, v: av(g)}));
    const max = Math.max(...vals.map(x=>x.v));
    const scale = n => Math.round((n/max)*120)+10;
    let x=60;
    vals.forEach(({g,v})=>{ drawBar(svg, x, scale(v), g); x+=80; });
  }

  // Ø¨Ù†Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø© Ø³Ø±ÙŠØ¹Ø©
  function buildQuiz(){
    const pick = arr => arr[Math.floor(Math.random()*arr.length)];
    const q1S = pick(SPECIES);
    const q2S = pick(SPECIES);
    const q3S = pick(SPECIES);
    const html = `
      <div class="quiz-q" data-ans="${q1S.size}">
        <h4>Ù¡) Ù…Ø§ Ø­Ø¬Ù… <b>${q1S.name}</b>ØŸ</h4>
        <div class="bar">
          ${['ØµØºÙŠØ±','Ù…ØªÙˆØ³Ø·','ÙƒØ¨ÙŠØ±'].map(x=>`<label><input type="radio" name="q1" value="${x}"> ${x}</label>`).join(' ')}
        </div>
      </div>
      <div class="quiz-q" data-ans="${q2S.region}">
        <h4>Ù¢) Ø£ÙŠÙ† ÙŠÙ†ØªØ´Ø± <b>${q2S.name}</b> ØºØ§Ù„Ø¨Ø§Ù‹ØŸ</h4>
        <div class="bar">
          ${['Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§','Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§','Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©','Ø£ÙØ±ÙŠÙ‚ÙŠØ§','Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ù†Ø¯ÙŠ'].map(x=>`<label><input type="radio" name="q2" value="${x}"> ${x}</label>`).join(' ')}
        </div>
      </div>
      <div class="quiz-q" data-ans="${q3S.diet}">
        <h4>Ù£) Ù…Ø§ ØºØ°Ø§Ø¡ <b>${q3S.name}</b> Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØŸ</h4>
        <input class="input" name="q3" placeholder="Ø§ÙƒØªØ¨ Ù…Ø«Ø§Ù„Ø§Ù‹ (Ø£Ø³Ù…Ø§Ùƒ/ÙƒØ±ÙŠÙ„/Ø±ÙˆØ¨ÙŠØ§Ù†â€¦)"/>
      </div>
    `;
    $('#quiz').innerHTML = html;
  }

  function checkQuiz(){
    let score = 0; let total = 3;
    const q1 = $$('#quiz .quiz-q')[0];
    const v1 = (q1.querySelector('input:checked')||{}).value;
    if(v1===q1.dataset.ans) score++;
    const q2 = $$('#quiz .quiz-q')[1];
    const v2 = (q2.querySelector('input:checked')||{}).value;
    if((q2.dataset.ans||'').includes(v2)) score++;
    const q3 = $$('#quiz .quiz-q')[2];
    const v3 = (q3.querySelector('input')||{}).value||'';
    if((q3.dataset.ans||'').includes(v3.trim())) score++;
    $('#quizResult').textContent = `Ù†ØªÙŠØ¬ØªÙƒ: ${score} / ${total}`;
  }

  // Ù†Ø·Ù‚
  function speak(text){
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'ar';
    speechSynthesis.speak(u);
  }

  // ØªØ¨ÙˆÙŠØ¨Ø§Øª
  function setupTabs(){
    const tabs = $$('.tab');
    tabs.forEach(t=> t.addEventListener('click', ()=>{
      tabs.forEach(x=>x.setAttribute('aria-selected','false'));
      t.setAttribute('aria-selected','true');
      const id = t.dataset.tab;
      $$('#panels > section').forEach(p=> p.hidden = true);
      $('#panel-'+id).hidden = false;
    }));
  }

  // Ø±Ø³Ù… ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
  function render(){
    const data = filterAll();
    $('#grid').innerHTML = data.map(speciesCard).join('');
    $('#kTotal').textContent = SPECIES.length;
    $('#kThreat').textContent = SPECIES.filter(s=> s.status.includes('Ù…Ù‡Ø¯Ø¯')).length;
    $('#kAvgH').textContent = fmt(Math.round(SPECIES.reduce((a,c)=>a+c.height_cm,0)/SPECIES.length)) + ' Ø³Ù…';
    $('#kAvgW').textContent = fmt((SPECIES.reduce((a,c)=>a+c.weight_kg,0)/SPECIES.length).toFixed(1)) + ' ÙƒØ¬Ù…';
    $('#chipCount').textContent = `${data.length} Ù†ÙˆØ¹`;

    // ÙØªØ­ Ø§Ù„ØªÙØ§ØµÙŠÙ„
    $$('#grid [data-open]').forEach(btn=> btn.onclick = ()=> openDetails(btn.dataset.open));

    // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„
    buildTable(data);
  }

  // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  function download(filename, text){
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([text], {type:'application/json'}));
    a.download = filename; a.click();
  }

  // ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ Ø¨Ø³ÙŠØ· Ø¨ØªØºÙŠÙŠØ± Ø§Ù„Ø®Ù„ÙÙŠØ©
  function toggleTheme(){
    const pressed = $('#themeBtn').getAttribute('aria-pressed') === 'true';
    $('#themeBtn').setAttribute('aria-pressed', String(!pressed));
    if(pressed){
      document.documentElement.style.setProperty('--bg', '#0b1320');
      document.documentElement.style.setProperty('--panel', '#121a2b');
      document.documentElement.style.setProperty('--panel-2', '#0f1626');
      document.documentElement.style.setProperty('--text', '#f2f5ff');
    } else {
      document.documentElement.style.setProperty('--bg', '#f6fbff');
      document.documentElement.style.setProperty('--panel', '#ffffff');
      document.documentElement.style.setProperty('--panel-2', '#f2f6fb');
      document.documentElement.style.setProperty('--text', '#0b1320');
    }
  }

  // Ø²Ø± Ù„Ù„Ø£Ø¹Ù„Ù‰
  function setupToTop(){
    const btn = $('#toTop');
    window.addEventListener('scroll', ()=>{
      if(window.scrollY > 300) btn.classList.add('show'); else btn.classList.remove('show');
    });
    btn.onclick = ()=> window.scrollTo({top:0, behavior:'smooth'});
  }

  // Ø£Ø­Ø¯Ø§Ø« Ø±Ø¦ÙŠØ³ÙŠØ©
  window.addEventListener('DOMContentLoaded', ()=>{
    setupTabs();
    drawChart();
    render();
    buildQuiz();
    setupToTop();

    // ØªÙØ§Ø¹Ù„Ø§Øª Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©
    ['q','filterRegion','filterSize'].forEach(id=> $("#"+id).addEventListener('input', ()=> render()));

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
    $('#closeDlg').onclick = ()=> $('#dlg').close();

    // ØªÙ†Ø²ÙŠÙ„ JSON
    $('#downloadJson').onclick = ()=> download('penguins.json', JSON.stringify(SPECIES, null, 2));

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù…Ø©
    $('#themeBtn').onclick = toggleTheme;

    // Ø§Ø®ØªØ¨Ø§Ø±
    $('#checkQuiz').onclick = checkQuiz;
    $('#regenQuiz').onclick = buildQuiz;

    // Ù…ÙØ§ØªÙŠØ­
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape' && $('#dlg').open) $('#dlg').close();
      if(e.key==='/' && document.activeElement.tagName!=='INPUT') { e.preventDefault(); $('#q').focus(); }
    });
  });
  </script>
</body>
</html>